---
aliases: как писать коммиты, ci, commit
tags: 
date created: Wednesday, March 30th 2022, 5:18:57 pm
date modified: Monday, April 11th 2022, 6:42:39 pm
title: Conventional Commits 1.0.0
---

- [[Специфификация ]]
- [[Описание коммита Commit early Commit often]]
- [[История использования коммитов]]
- [[Коммиты студии]]

# Conventional Commits 1.0.0

###  Почему надо исользовать?

- Упростите людям участие в ваших проектах, позволив им изучить более структурированную историю коммитов.
- позволяет создавать **[[CHANGELOG]]** при помощи скриптов
- позволяет игнорировать не важные коммиты  **[[git bisect]]** (форматирование)
- предоставляет лучшее информативность при просмотре истории. Другим разработчикам легче принимать участие в проектах, с более структурированной историей коммитов.
- наличие типов заставляет разработчика думать об атомарности коммитов. Чем меньше коммит тем лучше (Commit early Commit often)
- автоматическое определение семантического повышения версии (на основе _типов_ совершённых коммитов). [[Семантическое Версионирование 2.0.0|SemVer]]  
	

### Павила

Сообщение commit состоит из заголовка, тела и нижнего колонтитула(footer). Заголовок имеет специальный формат, который включает в себя тип, область действия и тему(subject)

Любая строка сообщения не может быть длиннее 100 символов! Это позволяет легче читать сообщение на github, а также в различных инструментах git.

Правила subject:

- пишеться с маленькой буквы
- точка в конце не ставится
- использовать повелительное наклонение, настроящее время ( **“change” not “changed” nor “changes” | не “удалил, удаления“, а “удалить”**)
- также было бы неплохо соблюдать правила [[Описание коммита Commit early Commit often|Уважительного коммита]]

```bash
<type>(<scope>): <subject>
<BLANK LINE>
<body>
<BLANK LINE>
<footer>

```

`type` - обязательный элемент
`<scope>, <body>, <footer>` - опциональный элемент

### Типы

**Новая версия**.  [AngularJS Commit Message Guidelines](https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#:~:text=commit%20being%20reverted.-,Type,-Must%20be%20one) 2018 год. Используется для [разработки AngularJS](https://github.com/angular/angular/commits/master):

- **build**: Changes that affect the build system or external dependencies (example scopes: gulp, broccoli, npm)
- **ci**: Changes to our CI configuration files and scripts (example scopes: Travis, Circle, BrowserStack, SauceLabs)
- **docs**: Documentation only changes
- **feat**: introduces a new feature to the codebase  (соответствует [[Семантическое Версионирование 2.0.0#MINOR|`MINOR`]] в Cемантическом Версионировании).
- **fix**: patches a bug in your codebase (соответствует [[Семантическое Версионирование 2.0.0#PATCH|`PATCH`]] в Cемантическом Версионировании).
- **perf**: A code change that improves performance
- **refactor**: A code change that neither fixes a bug nor adds a feature
- **style**: Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)
- **test**: Adding missing tests or correcting existing tests
- **revert**: If the commit reverts a previous commit.

Более **старая версия**. Представленна [angular](https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.t7ifoyph8bd3) в 2011 году. Команда[ GitHub octokit](https://github.com/octokit/octokit.js/commits/main) использует новую и старую версию вместе:

- **feat** (feature)
- **fix** (bug fix)
- **docs** (documentation)
- **style** (formatting, missing semi colons, …)
- **refactor**
- **test** (when adding missing tests)
- **chore** (maintain)

По сути тип **chore** в новой версии был убран, а типы: **ci**, **perf**, **build** добалены

Типы описанные в конфигурации [**commitlint**](https://github.com/conventional-changelog/commitlint/tree/master/%40commitlint/config-conventional)

```
  'build',
  'chore',
  'ci',
  'docs',
  'feat',
  'fix',
  'perf',
  'refactor',
  'revert',
  'style',
  'test'
```

### scope (область видимости, контекст)

scope- информация содержащая контекст изменений. Предназначена способствовать беглому чтению и пониманию истории коммитов.

В большенстве случаев туже информацию можно понять из просмотра изменений коммита, но это медленно.

 _Контекст_ может быть добавлен к _типу_ коммита. Например, `feat(parser): add ability to parse arrays`.

Основная задача контекста - показать место изменений commit-а. Например:
1. название папки включающей все измененяемые файлы
2. имя конкретного файла
3. можно использовать *, если нет более подходящей области
4. можно перечислять области через запятую (`feat(parser,src,public): add ability to parse arrays`)
	

### Body

Опционально может содержать дополнительную информацию о том, что послужило причиной изменений  и разнину между старым поведением и новым.

Для описание следует использовать повелительное наклонение, настоящее время.
 

### footer (сноски)

footer отделяется от body одной пустой строкой. Может содержать одну или несколько сносок. Сноски разделяются одной пустой строкой.

 Каждая _сноска_ должна состоять из токена, за которым следует разделитель (`:<space>` ) за которым следует строковое значение (основаное на [git trailer format](https://git-scm.com/docs/git-interpret-trailers)).
 
  ```js
 token: value
 ```
 
 Токен _сноски_ должен  использовать `-` вместо пробельных символов. Например, `Acked-by` (это помогает отличить раздел _сноски_ от его _тела_, состоящего из нескольких абзацев). Исключение составляет `BREAKING CHANGE`, которое может (MAY) также использоваться как токен. `BREAKING CHANGE` является полным синонимом `BREAKING-CHANGE`.
 

#### Виды сносок

**BREAKING CHANGE:**
Используется для упоминания изменений нарушающих обратную совместимость. Соответствует [[Семантическое Версионирование 2.0.0#MAJOR|`MAJOR`]]-ому повышению версии. Остальная часть сообщения должна представлять собой описание изменений, обоснование и примечания к миграции.
'BREAKING CHANGE' может быть частью коммита любого типа.

Альтернативная возможность упоминания  изменений нарушающих обратную совместимость - это вставка `!` перед `:`. В таком случае сноска' BREAKING CHANGE' имеет опциональный характер.

```
feat(api)!: send an email to the customer when a product is shipped
```

```
feat!: drop support for Node 6

BREAKING CHANGE: use JavaScript features not available in Node 6.
```

**Closes**
Служит для для обозначение задачи, которую закрывает коммит

```js
Closes: #123
```

в случае нескольких задач

```js
Closes: #123, #245, #992
```

##   FAQ

###   Как это связано с Семантическим Версионированием?

Коммиты _типа_ `fix` должны быть переведены в выпуски `PATCH`, `feat` — в `MINOR`, `BREAKING CHANGE`, независимо от _типа_, — в `MAJOR`.

###   Как мне поступать с сообщениями коммитов на начальном этапе разработки?

Мы рекомендуем действовать так, как если бы вы уже выпустили продукт. Обычно _кто-то_, даже если это ваши коллеги-разработчики программного обеспечения, использует ваше программное обеспечение. Они захотят знать, что исправлено, что ломается и т. д.

###   Как  обрабатывать отмену коммитов?

Отмена изменений кода может быть сложным:

- Вы отменяете изменения нескольких коммитов?
- Если вы отмените изменения новых функций, должен ли следующий выпуск быть патчем?

«Соглашение о коммитах» не делает явных попыток определить поведение отмены изменений. Вместо этого мы оставляем авторам инструментов использовать гибкость _типов_ и _сносок_ для разработки своей логики для обработки отмены изменений.

Одна из рекомендаций — использовать _тип_ `revert` и _сноску_, которая ссылается на отменяемые хэш-суммы коммитов. Например:

```
revert: let us never again speak of the noodle incident

Refs: 676104e, a215868
```

Либо указать хэш-суммы коммитов в body коммита

```
revert: let us never again speak of the noodle incident

This reverts commits: 676104e, a215868.
```

---

###### References

https://docs.google.com/document/d/1lyE8dxRPRe0yQvmbC-hmspltujHTEDbwfOXF9Sywq-g/edit

[[Merge requests]]

- [Соглашение о коммитах](https://www.conventionalcommits.org/en/v1.0.0/)
- [Keep a CHANGELOG](https://keepachangelog.com/en/0.3.0/)
- [Semantic Versioning 2.0.0](https://semver.org/)

**Англуляр**

- [AngularJS Git Commit Message Conventions](https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#) - Первая статья 2011год
- [AngularJS CONTRIBUTING.md](https://github.com/angular/angular/blob/22b96b9/CONTRIBUTING.md#-commit-message-guidelines) - Новая версия 2018год

**Автоматизация**

- [conventional-changelog](https://github.com/conventional-changelog)/**[commitlint](https://github.com/conventional-changelog/commitlint)**
- [conventional-changelog](https://github.com/conventional-changelog)/**[standard-version](https://github.com/conventional-changelog/standard-version)** - A utility for versioning using [semver](https://semver.org/) and CHANGELOG
- [conventional-changelog](https://github.com/conventional-changelog)/**[conventional-changelog](https://github.com/conventional-changelog/conventional-changelog)** - Generate a CHANGELOG from git metadata
- [commitizen](https://github.com/commitizen)/**[cz-cli](https://github.com/commitizen/cz-cli)** [Visual Studio Code Commitizen Support](https://marketplace.visualstudio.com/items?itemName=KnisterPeter.vscode-commitizen)

 Uncovered

- [Use GitLab](https://docs.gitlab.com/ee/user/)
- https://gitmoji.dev/ - можно заменять типы смайлами по приколу [Gitmoji Commit VS code ](https://marketplace.visualstudio.com/items?itemName=benjaminadk.emojis4git)
- [GitLab Workflow](https://marketplace.visualstudio.com/items?itemName=GitLab.gitlab-workflow)

YT

- [Git Project Setup with Husky, Conventional Commits, and branching strategies.](https://www.youtube.com/watch?v=jNxDNoYEGVU)

Умалат
